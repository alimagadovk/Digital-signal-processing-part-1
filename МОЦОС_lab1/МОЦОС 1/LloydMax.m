function [res, t, d] = LloydMax(f, m, sigma, bitcount)
if bitcount == 1
    t = [-inf 0.0 inf];
    d = [-0.7979 0.7979];
elseif bitcount == 2
    t = [-inf -0.9816 0.0 0.9816 inf];
    d = [-1.5104 -0.4528 0.4528 1.5104];
elseif bitcount == 3
    t = [-inf -1.7479 -1.0500 -0.5005 0.0 0.5005 1.0500 1.7479 inf];
    d = [-2.1519 -1.3439 -0.7560 -0.2451 0.2451 0.7560 1.3439 2.1519];
else
    t = [-inf -2.4008 -1.8435 -1.4371 -1.0993 -0.7995 -0.5224 -0.2582 0.0 0.2582 0.5224 0.7995 1.0993 1.4371 1.8435 2.4008 inf];
    d = [-2.7326 -2.0690 -1.6180 -1.2562 -0.9423 -0.6568 -0.3880 -0.1284 0.1284 0.3880 0.6568 0.9423 1.2562 1.6180 2.0690 2.7326];
end
t = t*sigma + m;
d = d*sigma + m;
res = zeros(size(f));
for i = 1:length(f)
    n = find(t>f(i));
    res(i) = d(n(1)-1);
end
end